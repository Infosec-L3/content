category: Authentication
commonfields:
  id: AttackIQFireDrill
  version: -1
configuration:
- display: Server URL (e.g. https://example.net)
  name: url
  required: true
  type: 0
- display: API Token
  name: token
  required: true
  type: 4
- display: Trust any certificate (insecure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy
  name: proxy
  required: false
  type: 8
description: AttackIQ offers continuous validation for security controls, processes
  and people.
display: AttackIQ FireDrill
name: AttackIQFireDrill
script:
  commands:
  - arguments:
    - default: false
      description: Assessment Id
      isArray: false
      name: assessment_id
      required: false
      secret: false
    - default: false
      defaultValue: '1'
      description: Assessment page. Each page contains by default up to 10 assessments.
      isArray: false
      name: page_number
      required: false
      secret: false
    deprecated: false
    description: Get all assessments in a page or by assessment id.
    execution: false
    name: attackiq-list-assessments
    outputs:
    - contextPath: AttackIQ.Assessment.Id
      type: String
    - contextPath: AttackIQ.Assessment.Name
      type: String
    - contextPath: AttackIQ.Assessment.Description
      type: String
    - contextPath: AttackIQ.Assessment.StartDate
      type: Date
    - contextPath: AttackIQ.Assessment.EndDate
      type: Date
    - contextPath: AttackIQ.Assessment.ProjectState
      type: String
    - contextPath: AttackIQ.Assessment.DefaultSchedule
      type: String
    - contextPath: AttackIQ.Assessment.ProjectTemplate.Id
      type: String
    - contextPath: AttackIQ.Assessment.ProjectTemplate.TemplateName
      type: String
    - contextPath: AttackIQ.Assessment.ProjectTemplate.TemplateDescription
      type: String
    - contextPath: AttackIQ.Assessment.ProjectTemplate.ProjectTemplateType.Id
      type: String
    - contextPath: AttackIQ.Assessment.ProjectTemplate.ProjectTemplateType.Name
      type: String
    - contextPath: AttackIQ.Assessment.ProjectTemplate.ProjectTemplateType.Description
      type: String
    - contextPath: AttackIQ.Assessment.ProjectTemplate.DefaultSchedule
      type: Unknown
    - contextPath: AttackIQ.Assessment.ProjectTemplate.Company
      type: String
    - contextPath: AttackIQ.Assessment.ProjectTemplate.Created
      type: String
    - contextPath: AttackIQ.Assessment.ProjectTemplate.Modified
      type: String
    - contextPath: AttackIQ.Assessment.Creator
      type: String
    - contextPath: AttackIQ.Assessment.Owner
      type: String
    - contextPath: AttackIQ.Assessment.User
      type: String
    - contextPath: AttackIQ.Assessment.Created
      type: String
    - contextPath: AttackIQ.Assessment.Modified
      type: String
    - contextPath: AttackIQ.Assessment.Users
      type: String
    - contextPath: AttackIQ.Assessment.Groups
      type: String
    - contextPath: AttackIQ.Assessment.DefaultAssetCount
      type: Number
    - contextPath: AttackIQ.Assessment.DefaultAssetGroupCount
      type: Number
    - contextPath: AttackIQ.Assessment.MasterJobCount
      type: Number
  - arguments:
    - default: false
      description: The assessment to activate
      isArray: false
      name: assessment_id
      required: false
      secret: false
    deprecated: false
    description: Activates the assessment. this is required for execution.
    execution: false
    name: attackiq-activate-assessment
  - arguments:
    - default: false
      description: The assessment to activate
      isArray: false
      name: assessment_id
      required: false
      secret: false
    - default: false
      description: Run only on-demand tests in the project, or all tests\ntrue - Execute
        only the on-demand tests in the project\nfalse - Execute all tests in the
        project (including scheduled tests)
      isArray: false
      name: on_demand_only
      required: false
      secret: false
    deprecated: false
    description: runs all of the tests in the assessment.
    execution: false
    name: attackiq-run-all-tests-in-assessment
  - arguments:
    - default: false
      description: The assessment to check status
      isArray: false
      name: assessment_id
      required: false
      secret: false
    deprecated: false
    description: Get assessment execution status - supports only on demand runs.
    execution: false
    name: attackiq-get-assessment-execution-status
    outputs:
    - contextPath: AttackIQ.Assessment.Running
      type: Boolean
    - contextPath: AttackIQ.Assessment.Id
      description: Assessment Id
      type: String
  - arguments:
    - default: true
      description: The test to check status
      isArray: false
      name: test_id
      required: true
      secret: false
    deprecated: false
    description: Get test run status.
    execution: false
    name: attackiq-get-test-execution-status
    outputs:
    - contextPath: AttackIQ.Test.Detected
      type: Number
    - contextPath: AttackIQ.Test.Failed
      type: Number
    - contextPath: AttackIQ.Test.Finished
      type: Boolean
    - contextPath: AttackIQ.Test.Passed
      type: Number
    - contextPath: AttackIQ.Test.Errored
      type: Number
    - contextPath: AttackIQ.Test.Total
      type: Number
    - contextPath: AttackIQ.Test.Id
      description: ID of the assessment test.
      type: String
  - arguments:
    - default: false
      description: The assessment to run tests for
      isArray: false
      name: assessment_id
      required: false
      secret: false
    deprecated: false
    execution: false
    name: attackiq-list-tests-by-assessment
    outputs:
    - contextPath: AttackIQ.Test.Id
      type: String
    - contextPath: AttackIQ.Test.Name
      type: String
    - contextPath: AttackIQ.Test.Description
      type: String
    - contextPath: AttackIQ.Test.Project
      type: String
    - contextPath: AttackIQ.Test.Scenarios.Id
      type: String
    - contextPath: AttackIQ.Test.Scenarios.Name
      type: String
    - contextPath: AttackIQ.Test.Assets.Id
      type: String
    - contextPath: AttackIQ.Test.Assets.Ipv4Address
      type: String
    - contextPath: AttackIQ.Test.Assets.Hostname
      type: String
    - contextPath: AttackIQ.Test.Assets.ProductName
      type: String
    - contextPath: AttackIQ.Test.Assets.Modified
      type: String
    - contextPath: AttackIQ.Test.Assets.Status
      type: String
    - contextPath: AttackIQ.Test.TotalAssetCount
      type: Number
    - contextPath: AttackIQ.Test.CronExpression
      type: String
    - contextPath: AttackIQ.Test.Runnable
      type: Boolean
    - contextPath: AttackIQ.Test.LastResult
      type: String
    - contextPath: AttackIQ.Test.ScheduledCount
      type: Number
    - contextPath: AttackIQ.Test.User
      type: String
    - contextPath: AttackIQ.Test.Created
      type: String
    - contextPath: AttackIQ.Test.Modified
      type: String
    - contextPath: AttackIQ.Test.LatestInstanceId
      type: Number
    - contextPath: AttackIQ.Test.UsingDefaultAssets
      type: Boolean
    - contextPath: AttackIQ.Test.UsingDefaultSchedule
      type: Boolean
  - arguments:
    - default: false
      description: The test to show results for
      isArray: false
      name: test_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      description: Only show the most recent results
      isArray: false
      name: show_last_result
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    - default: false
      defaultValue: '1'
      description: Page number of test results (by default there are 10 results per
        page)
      isArray: false
      name: page
      required: false
      secret: false
    deprecated: false
    execution: false
    name: attackiq-get-test-results
    outputs:
    - contextPath: AttackIQ.TestResult.Id
      type: String
    - contextPath: AttackIQ.TestResult.Modified
      type: String
    - contextPath: AttackIQ.TestResult.Project.Id
      type: String
    - contextPath: AttackIQ.TestResult.Project.Name
      type: String
    - contextPath: AttackIQ.TestResult.MasterJob.Id
      type: String
    - contextPath: AttackIQ.TestResult.MasterJob.Assets.Ipv4Address
      type: String
    - contextPath: AttackIQ.TestResult.MasterJob.Assets.Hostname
      type: String
    - contextPath: AttackIQ.TestResult.MasterJob.Assets.Id
      type: String
    - contextPath: AttackIQ.TestResult.MasterJob.Assets.ProductName
      type: String
    - contextPath: AttackIQ.TestResult.MasterJob.Assets.Modified
      type: String
    - contextPath: AttackIQ.TestResult.MasterJob.Assets.Status
      type: String
    - contextPath: AttackIQ.TestResult.MasterJob.Scenarios.Id
      type: String
    - contextPath: AttackIQ.TestResult.MasterJob.Scenarios.Name
      type: String
    - contextPath: AttackIQ.TestResult.MasterJob.Scenarios.Description
      type: String
    - contextPath: AttackIQ.TestResult.MasterJob.Scenarios.CategoryId
      type: String
    - contextPath: AttackIQ.TestResult.MasterJob.Scenarios.CategoryName
      type: String
    - contextPath: AttackIQ.TestResult.RunCount
      type: String
    - contextPath: AttackIQ.TestResult.LastResult
      type: String
    - contextPath: AttackIQ.TestResult.Scenario.Id
      type: String
    - contextPath: AttackIQ.TestResult.Scenario.Name
      type: String
    - contextPath: AttackIQ.TestResult.Scenario.Description
      type: String
    - contextPath: AttackIQ.TestResult.Scenario.Category.Id
      type: String
    - contextPath: AttackIQ.TestResult.Scenario.Category.Name
      type: String
    - contextPath: AttackIQ.TestResult.Asset.Id
      type: String
    - contextPath: AttackIQ.TestResult.Asset.Ipv4Address
      type: String
    - contextPath: AttackIQ.TestResult.Asset.Hostname
      type: String
    - contextPath: AttackIQ.TestResult.Asset.category.Id
      type: String
    - contextPath: AttackIQ.TestResult.Asset.Category.Name
      type: String
    - contextPath: AttackIQ.TestResult.Asset.ProductName
      type: String
    - contextPath: AttackIQ.TestResult.Asset.Modified
      type: String
    - contextPath: AttackIQ.TestResult.Asset.Status
      type: String
    - contextPath: AttackIQ.TestResult.AssetGroup
      type: Unknown
    - contextPath: AttackIQ.TestResult.JobState.Name
      type: String
    - contextPath: AttackIQ.TestResult.Outcome.Name
      type: String
  dockerimage: demisto/python3:3.7.4.977
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  type: python
tests:
  - AttackIQ - Test
