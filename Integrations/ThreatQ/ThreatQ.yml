category: Data Enrichment & Threat Intelligence
commonfields:
  id: ThreatQ
  version: -1
configuration:
- display: TQ API URL E.g. https://192.168.1.136/api
  name: apiUrl
  required: true
  type: 0
- display: TQ Client ID
  name: client_id
  required: true
  type: 0
- display: Email
  name: credentials
  required: true
  type: 9
- defaultvalue: 'false'
  display: Insecure
  name: insecure
  required: false
  type: 8
- display: Use system proxy
  name: proxy
  required: false
  type: 8
description: ThreatQ Integration
display: ThreatQ
name: ThreatQ
script:
  commands:
  - arguments:
    - default: true
      defaultValue: Naid
      description: keyword
      isArray: false
      name: keyword
      required: true
      secret: false
    deprecated: false
    description: Search ThreatQ repository by keywords
    execution: false
    name: tq-search-by-name
    outputs:
    - contextPath: ThreatQ.description
      description: Description
      type: Unknown
  - arguments:
    - default: false
      defaultValue: 8.8.8.8
      description: IP address
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Run ip check against ThreatQ
    execution: false
    name: ip
    outputs:
    - contextPath: ThreatQ.score
      description: ThreatQ score
      type: Unknown
    - contextPath: ThreatQ.name
      description: ThreatQ name
      type: Unknown
    - contextPath: DBotScore.Vendor
      description: DBotScore Vendor
      type: Unknown
    - contextPath: DBotScore.Malicious
      description: DBotScore Malicious status
      type: Unknown
  - arguments:
    - default: false
      defaultValue: www.google.com
      description: URL or FQDN
      isArray: false
      name: url
      required: true
      secret: false
    deprecated: false
    description: Run url check against ThreatQ
    execution: false
    name: url
    outputs:
    - contextPath: ThreatQ.score
      description: ThreatQ score
      type: Unknown
    - contextPath: ThreatQ.name
      description: ThreatQ name
      type: Unknown
    - contextPath: DBotScore.Vendor
      description: DBotScore Vendor
      type: Unknown
    - contextPath: DBotScore.Malicious
      description: DBotScore Malicious status
      type: Unknown
  - arguments:
    - default: false
      defaultValue: google.exe
      description: File name, MD5 or SHA
      isArray: false
      name: file
      required: false
      secret: false
    deprecated: false
    description: Run file check against ThreatQ
    execution: false
    name: file
    outputs:
    - contextPath: ThreatQ.score
      description: ThreatQ score
      type: Unknown
    - contextPath: ThreatQ.name
      description: ThreatQ name
      type: Unknown
    - contextPath: DBotScore.Vendor
      description: DBotScore Vendor
      type: Unknown
    - contextPath: DBotScore.Malicious
      description: DBotScore Malicious status
      type: Unknown
  - arguments:
    - default: false
      defaultValue: example@gmail.com
      description: pre-commit
      isArray: false
      name: email
      required: true
      secret: false
    deprecated: false
    description: Run email check agasint ThreatQ
    execution: false
    name: email
    outputs:
    - contextPath: ThreatQ.score
      description: ThreatQ score
      type: Unknown
    - contextPath: ThreatQ.name
      description: ThreatQ name
      type: Unknown
    - contextPath: DBotScore.Vendor
      description: DBotScore Vendor
      type: Unknown
    - contextPath: DBotScore.Malicious
      description: DBotScore Malicious status
      type: Unknown
  - arguments:
    - default: false
      description: pre-commit
      isArray: false
      name: domain
      required: true
      secret: false
    deprecated: false
    description: Run domain check against ThreatQ
    execution: false
    name: domain
    outputs:
    - contextPath: ThreatQ.score
      description: ThreatQ score
      type: Unknown
    - contextPath: ThreatQ.name
      description: ThreatQ name
      type: Unknown
    - contextPath: DBotScore.Vender
      description: DBotScore Vender
      type: Unknown
    - contextPath: DBotScore.Malicious
      description: DBotScore Malicious status
      type: Unknown
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Indicator type
      isArray: false
      name: type
      predefined:
      - IP Address
      - URL
      - Domain
      - Email Address
      - File
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Indicator status
      isArray: false
      name: status
      predefined:
      - Active
      - Expired
      - Indirect
      - Review
      - Whitelisted
      required: true
      secret: false
    - default: false
      description: Indicator value
      isArray: false
      name: value
      required: true
      secret: false
    - default: false
      description: Source(s) name(s)
      isArray: true
      name: sources_lst
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: TLP
      isArray: true
      name: tlp_lst
      predefined:
      - RED
      - AMBER
      - GREEN
      - WHITE
      required: false
      secret: false
    deprecated: false
    description: Create an indicator
    execution: false
    name: create-ioc
  - arguments:
    - default: false
      description: The attribute name
      isArray: false
      name: name
      required: true
      secret: false
    deprecated: false
    description: Create an attribute
    execution: false
    name: create-attr
  - arguments:
    - default: false
      description: Object value
      isArray: false
      name: obj_keyword
      required: true
      secret: false
    - default: false
      description: Attribute value
      isArray: false
      name: attr_keyword
      required: true
      secret: false
    deprecated: false
    description: Add an attribute to an object
    execution: false
    name: add-attr
  - arguments:
    - default: false
      description: First object
      isArray: false
      name: obj1_keyword
      required: true
      secret: false
    - default: false
      description: Second object
      isArray: false
      name: obj2_keyword
      required: true
      secret: false
    deprecated: false
    description: Link between two objects
    execution: false
    name: link-objects
  - arguments:
    - default: false
      description: Adversary name
      isArray: false
      name: name
      required: true
      secret: false
    - default: false
      description: Source(s) name(s)
      isArray: true
      name: source_lst
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: TLP
      isArray: true
      name: tlp_lst
      predefined:
      - RED
      - AMBER
      - GREEN
      - WHITE
      required: false
      secret: false
    deprecated: false
    description: Create a new Adversary
    execution: false
    name: create-adversary
  - arguments:
    - default: false
      description: Event title
      isArray: false
      name: title
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Event type
      isArray: false
      name: type
      predefined:
      - Spearphish
      - Watering Hole
      - SQL Injection Attack
      - DoS Attack
      - Malware
      - Watchlist
      - Command and Control
      - Anonymization
      - Exfiltration
      - Host Characteristics
      - Compromised PKI Certificate
      - Login Compromise
      - Incident
      required: true
      secret: false
    - default: false
      defaultValue: 01.01.2000
      description: Date of Occurence
      isArray: false
      name: date
      required: true
      secret: false
    deprecated: false
    description: Create a new Event
    execution: false
    name: create-event
  isfetch: false
  runonce: false
  script: '-'
  type: python
tests:
- No test
