category: Data Enrichment & Threat Intelligence
commonfields:
  id: ThreatQ
  version: -1
configuration:
- display: TQ API URL E.g. https://192.168.1.136/api
  name: apiUrl
  required: true
  type: 0
- display: TQ Client ID
  name: client_id
  required: true
  type: 0
- display: Email
  name: credentials
  required: true
  type: 9
- defaultvalue: 'false'
  display: Insecure
  name: insecure
  required: false
  type: 8
- display: Use system proxy
  name: proxy
  required: false
  type: 8
description: ThreatQ Integration
display: ThreatQ
name: ThreatQ
script:
  commands:
  - arguments:
    - default: true
      defaultValue: Naid
      description: keyword
      isArray: false
      name: keyword
      required: true
      secret: false
    deprecated: false
    description: Search ThreatQ repository by keywords
    execution: false
    name: tq_search_by_name
    outputs:
    - contextPath: ThreatQ.description
      description: Description
      type: Unknown
  - arguments:
    - default: false
      defaultValue: 8.8.8.8
      description: IP address
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Run ip check against ThreatQ
    execution: false
    name: ip
    outputs:
    - contextPath: ThreatQ.score
      description: ThreatQ score
      type: Unknown
    - contextPath: ThreatQ.name
      description: ThreatQ name
      type: Unknown
    - contextPath: DBotScore.Vendor
      description: DBotScore Vendor
      type: Unknown
    - contextPath: DBotScore.Malicious
      description: DBotScore Malicious status
      type: Unknown
  - arguments:
    - default: false
      defaultValue: www.google.com
      description: URL or FQDN
      isArray: false
      name: url
      required: true
      secret: false
    deprecated: false
    description: Run url check against ThreatQ
    execution: false
    name: url
    outputs:
    - contextPath: ThreatQ.score
      description: ThreatQ score
      type: Unknown
    - contextPath: ThreatQ.name
      description: ThreatQ name
      type: Unknown
    - contextPath: DBotScore.Vendor
      description: DBotScore Vendor
      type: Unknown
    - contextPath: DBotScore.Malicious
      description: DBotScore Malicious status
      type: Unknown
  - arguments:
    - default: false
      defaultValue: google.exe
      description: File name, MD5 or SHA
      isArray: false
      name: file
      required: false
      secret: false
    deprecated: false
    description: Run file check against ThreatQ
    execution: false
    name: file
    outputs:
    - contextPath: ThreatQ.score
      description: ThreatQ score
      type: Unknown
    - contextPath: ThreatQ.name
      description: ThreatQ name
      type: Unknown
    - contextPath: DBotScore.Vendor
      description: DBotScore Vendor
      type: Unknown
    - contextPath: DBotScore.Malicious
      description: DBotScore Malicious status
      type: Unknown
  - arguments:
    - default: false
      defaultValue: example@gmail.com
      description: pre-commit
      isArray: false
      name: email
      required: true
      secret: false
    deprecated: false
    description: Run email check agasint ThreatQ
    execution: false
    name: email
    outputs:
    - contextPath: ThreatQ.score
      description: ThreatQ score
      type: Unknown
    - contextPath: ThreatQ.name
      description: ThreatQ name
      type: Unknown
    - contextPath: DBotScore.Vendor
      description: DBotScore Vendor
      type: Unknown
    - contextPath: DBotScore.Malicious
      description: DBotScore Malicious status
      type: Unknown
  - arguments:
    - default: false
      isArray: false
      name: domain
      description: pre-commit
      required: true
      secret: false
    deprecated: false
    description: Run domain check against ThreatQ
    execution: false
    name: domain
    outputs:
    - contextPath: ThreatQ.score
      description: ThreatQ score
      type: Unknown
    - contextPath: ThreatQ.name
      description: ThreatQ name
      type: Unknown
    - contextPath: DBotScore.Vender
      description: DBotScore Vender
      type: Unknown
    - contextPath: DBotScore.Malicious
      description: DBotScore Malicious status
      type: Unknown
  isfetch: false
  runonce: false
  script: '-'
  type: python
tests:
- No test
