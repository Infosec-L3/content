commonfields:
  id: ThreatQ
  version: -1
name: ThreatQ
display: ThreatQ
category: Data Enrichment & Threat Intelligence
image: data:image/png;base64,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
description: ThreatQ Integration
detaileddescription: "You must have a ThreatQ user account to retrieve an api token.
  The api token is required for all api requests. \nThreatQ provides indicator scoring
  weighting for indicators and their contextual information, such as sources, attributes,
  and indicator types, as they are added to ThreatQ.\nFor detailed information on
  ThreatQ scoring please refer to https://helpcenter.threatq.com/"
configuration:
- display: TQ SERVER URL E.g. https://192.168.1.136
  name: serverUrl
  defaultvalue: ""
  type: 0
  required: true
- display: TQ Client ID
  name: client_id
  defaultvalue: ""
  type: 0
  required: true
- display: Email
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Insecure
  name: insecure
  defaultvalue: "false"
  type: 8
  required: false
- display: Use system proxy
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
- display: Indicator threshold. Minimum TQ score to consider the indicator malicious.
  name: threshold
  defaultvalue: "8"
  type: 0
  required: false
script:
  script: ''
  type: python
  commands:
  - name: tq-search-by-name
    arguments:
    - name: keyword
      required: true
      default: true
      description: keyword
    - name: limit
      description: The maximum number of records to retrieve.
      defaultValue: "10"
    outputs:
    - contextPath: ThreatQ.ID
      description: Object's ID
      type: number
    - contextPath: ThreatQ.Value
      description: Object's value
      type: string
    - contextPath: ThreatQ.Type
      description: Object's type
      type: string
    description: Search ThreatQ repository by keywords. Search result default limit
      is 10 records.
  - name: ip
    arguments:
    - name: ip
      required: true
      description: IP address
      defaultValue: 8.8.8.8
    outputs:
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: string
    - contextPath: DBotScore.Type
      description: Indicator type
      type: string
    - contextPath: DBotScore.Vendor
      description: Indicator vendor
      type: string
    - contextPath: DBotScore.Score
      description: Indicator DBot Score
      type: number
    - contextPath: IP.Address
      description: IP Address
      type: string
    - contextPath: IP.Malicious.Vendor
      description: IP Vendor
      type: string
    - contextPath: IP.Malicious.Description
      description: IP Malicious description
      type: string
    - contextPath: ThreatQ.Type
      type: string
    - contextPath: ThreatQ.ID
      type: number
    - contextPath: ThreatQ.Value
      type: string
    - contextPath: ThreatQ.Sources.ID
      type: number
    - contextPath: ThreatQ.Sources.Name
      type: string
    - contextPath: ThreatQ.Attributes.ID
      type: number
    - contextPath: ThreatQ.Attributes.Value
      type: string
    - contextPath: ThreatQ.Attributes.Name
      type: string
    - contextPath: ThreatQ.CreatedAt
      type: date
    - contextPath: ThreatQ.UpdatedAt
      type: date
    - contextPath: ThreatQ.Status
      type: string
    - contextPath: ThreatQ.TQScore
      type: number
    - contextPath: ThreatQ.Description
      type: string
    - contextPath: ThreatQ.IndicatorType
      type: string
    description: Run ip check against ThreatQ
  - name: url
    arguments:
    - name: url
      required: true
      description: URL or FQDN
      defaultValue: www.google.com
    outputs:
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: string
    - contextPath: DBotScore.Type
      description: Indicator type
      type: string
    - contextPath: DBotScore.Vendor
      description: Indicator vendor
      type: string
    - contextPath: DBotScore.Score
      description: Indicator DBot Score
      type: number
    - contextPath: URL.Data
      description: URL
      type: string
    - contextPath: URL.Malicious.Vendor
      description: URL vendor
      type: string
    - contextPath: URL.Malicious.Description
      description: URL Malicious description
      type: string
    - contextPath: ThreatQ.Type
      type: string
    - contextPath: ThreatQ.ID
      type: number
    - contextPath: ThreatQ.Value
      type: string
    - contextPath: ThreatQ.Sources.ID
      type: number
    - contextPath: ThreatQ.Sources.Name
      type: string
    - contextPath: ThreatQ.Attributes.ID
      type: number
    - contextPath: ThreatQ.Attributes.Name
      type: string
    - contextPath: ThreatQ.Attributes.Value
      type: string
    - contextPath: ThreatQ.UpdatedAt
      type: date
    - contextPath: ThreatQ.CreatedAt
      type: date
    - contextPath: ThreatQ.Description
      type: string
    - contextPath: ThreatQ.Status
      type: string
    - contextPath: ThreatQ.IndicatorType
      type: string
    - contextPath: ThreatQ.TQScore
      type: number
    description: Run url check against ThreatQ
  - name: file
    arguments:
    - name: file
      description: File name, MD5 or SHA
      defaultValue: google.exe
    outputs:
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: string
    - contextPath: DBotScore.Type
      description: Indicator type
      type: string
    - contextPath: DBotScore.Vendor
      description: Indicator vendor
      type: string
    - contextPath: DBotScore.Score
      description: Indicator DBot Score
      type: number
    - contextPath: File.Name
      description: File name
      type: string
    - contextPath: File.MD5
      description: File MD5
      type: string
    - contextPath: File.SHA1
      description: File SHA1
      type: string
    - contextPath: File.SHA256
      description: File SHA256
      type: string
    - contextPath: File.SHA512
      description: File SHA512
      type: string
    - contextPath: File.Path
      description: File path
      type: string
    - contextPath: File.Malicious.Vendor
      description: File vendor
      type: string
    - contextPath: File.Malicious.Malicious
      description: File Malicious description
      type: string
    - contextPath: ThreatQ.Type
      type: string
    - contextPath: ThreatQ.ID
      type: number
    - contextPath: ThreatQ.Value
      type: string
    - contextPath: ThreatQ.Sources.ID
      type: number
    - contextPath: ThreatQ.Sources.Name
      type: string
    - contextPath: ThreatQ.Attributes.ID
      type: number
    - contextPath: ThreatQ.Attributes.Name
      type: string
    - contextPath: ThreatQ.Attributes.Value
      type: string
    - contextPath: ThreatQ.UpdatedAt
      type: date
    - contextPath: ThreatQ.CreatedAt
      type: date
    - contextPath: ThreatQ.Description
      type: string
    - contextPath: ThreatQ.Status
      type: string
    - contextPath: ThreatQ.IndicatorType
      type: string
    - contextPath: ThreatQ.TQScore
      type: number
    description: Run file check against ThreatQ
  - name: email
    arguments:
    - name: email
      required: true
      description: pre-commit
      defaultValue: example@gmail.com
    outputs:
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: string
    - contextPath: DBotScore.Type
      description: Indicator type
      type: string
    - contextPath: DBotScore.Vendor
      description: Indicator vendor
      type: string
    - contextPath: DBotScore.Score
      description: Indicator DBot Score
      type: number
    - contextPath: Email.From
      description: Email Address
      type: string
    - contextPath: Email.Malicious.Vendor
      description: Email vendor
      type: string
    - contextPath: Email.Malicious.Description
      description: Email Malicious description
      type: string
    - contextPath: ThreatQ.Type
      type: string
    - contextPath: ThreatQ.ID
      type: number
    - contextPath: ThreatQ.Value
      type: string
    - contextPath: ThreatQ.Sources.ID
      type: number
    - contextPath: ThreatQ.Sources.Name
      type: string
    - contextPath: ThreatQ.Attributes.ID
      type: number
    - contextPath: ThreatQ.Attributes.Name
      type: string
    - contextPath: ThreatQ.Attributes.Value
      type: string
    - contextPath: ThreatQ.UpdatedAt
      type: date
    - contextPath: ThreatQ.CreatedAt
      type: date
    - contextPath: ThreatQ.Description
      type: string
    - contextPath: ThreatQ.Status
      type: string
    - contextPath: ThreatQ.IndicatorType
      type: string
    - contextPath: ThreatQ.TQScore
      type: number
    description: Run email check against ThreatQ
  - name: domain
    arguments:
    - name: domain
      required: true
      description: pre-commit
    outputs:
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: string
    - contextPath: DBotScore.Vender
      description: Indicator vender
      type: string
    - contextPath: DBotScore.Type
      description: Indicator type
      type: string
    - contextPath: DBotScore.Score
      description: Indicator DBot Score
      type: number
    - contextPath: Domain.Name
      description: Domain name
      type: string
    - contextPath: Domain.Malicious.Vendor
      description: Domain vendor
      type: string
    - contextPath: Domain.Malicious.Description
      description: Domain Malicious description
      type: string
    - contextPath: ThreatQ.Type
      type: string
    - contextPath: ThreatQ.ID
      type: number
    - contextPath: ThreatQ.Value
      type: string
    - contextPath: ThreatQ.Sources.ID
      type: number
    - contextPath: ThreatQ.Sources.Name
      type: string
    - contextPath: ThreatQ.Attributes.ID
      type: number
    - contextPath: ThreatQ.Attributes.Name
      type: string
    - contextPath: ThreatQ.Attributes.Value
      type: string
    - contextPath: ThreatQ.UpdatedAt
      type: date
    - contextPath: ThreatQ.CreatedAt
      type: date
    - contextPath: ThreatQ.Description
      type: string
    - contextPath: ThreatQ.Status
      type: string
    - contextPath: ThreatQ.IndicatorType
      type: string
    - contextPath: ThreatQ.TQScore
      type: number
    description: Run domain check against ThreatQ
  - name: tq-create-ioc
    arguments:
    - name: ioc_type
      required: true
      description: Indicator type
    - name: status
      required: true
      auto: PREDEFINED
      predefined:
      - Active
      - Expired
      - Indirect
      - Review
      - Whitelisted
      description: Indicator status
    - name: value
      required: true
      description: Indicator value
    - name: source_lst
      description: Source(s) name(s)
      isArray: true
    - name: attr_lst
      description: Add attributes
      isArray: true
    - name: attr_vals
      description: Attributes values
      isArray: true
    outputs:
    - contextPath: ThreatQ.ID
      description: Object's ID
      type: number
    - contextPath: ThreatQ.Sources.ID
      description: Object's source ID
      type: number
    - contextPath: ThreatQ.Sources.Name
      description: Object's source name
      type: string
    - contextPath: ThreatQ.Attributes.ID
      description: Object's attribute ID
      type: number
    - contextPath: ThreatQ.Attributes.Name
      description: Object's attribute name
      type: string
    - contextPath: ThreatQ.Attributes.Value
      description: Object's attribute value
      type: string
    - contextPath: ThreatQ.CreatedAt
      description: Object's creation date
      type: date
    - contextPath: ThreatQ.UpdatedAt
      description: Object's last update date
      type: date
    - contextPath: ThreatQ.Description
      description: Description about the object
      type: string
    - contextPath: ThreatQ.Value
      description: The indicator's value
      type: string
    - contextPath: ThreatQ.Status
      description: The indicator's status - Active/Expired/Indirect/Review/Whitelisted
      type: string
    - contextPath: ThreatQ.Type
      description: The object's type - indicator/adversary/event
      type: string
    - contextPath: ThreatQ.IndicatorType
      description: The indicator's type, e.g IP Address
      type: string
    - contextPath: ThreatQ.TQScore
      description: The indicator's ThreatQ Score
      type: number
    description: Create a new indicator in ThreatQ
  - name: tq-add-attr
    arguments:
    - name: attr_name
      required: true
      description: The attribute name
    - name: attr_value
      required: true
      description: The Attribute value
    - name: obj_type
      required: true
      auto: PREDEFINED
      predefined:
      - indicator
      - event
      - adversary
      description: Object's type
    - name: obj_id
      required: true
      description: Object's ID
    description: Add an attribute to an object in ThreatQ
  - name: tq-modify-attr
    arguments:
    - name: obj_type
      required: true
      auto: PREDEFINED
      predefined:
      - indicator
      - adversary
      - event
      description: Object's type
    - name: obj_id
      required: true
      description: Object's ID
    - name: attr_id
      required: true
      description: Attribute id
    - name: attr_value
      required: true
      description: New attribute's value
    description: Modify an attribute on an object in ThreatQ
  - name: tq-link-objects
    arguments:
    - name: obj1_id
      required: true
      description: First object's ID
    - name: obj2_id
      required: true
      description: Second object's ID
    - name: obj1_type
      required: true
      auto: PREDEFINED
      predefined:
      - indicator
      - adversary
      - event
      description: First object's type
    - name: obj2_type
      required: true
      auto: PREDEFINED
      predefined:
      - indicator
      - adversary
      - event
      description: Second object's type
    description: Link between two objects in ThreatQ
  - name: tq-create-adversary
    arguments:
    - name: name
      required: true
      description: Adversary name
    - name: source_lst
      description: Source(s) name(s)
      isArray: true
    - name: attr_lst
      description: Add attributes
      isArray: true
    - name: attr_vals
      description: Attributes values
      isArray: true
    outputs:
    - contextPath: ThreatQ.Name
      description: The adversary's name
      type: string
    - contextPath: ThreatQ.Type
      description: The object type - adversary
      type: string
    - contextPath: ThreatQ.ID
      description: The adversary's ID
      type: number
    - contextPath: ThreatQ.Sources.ID
      description: The adversary's source ID
      type: number
    - contextPath: ThreatQ.Sources.Name
      description: The adversary's source name
      type: string
    - contextPath: ThreatQ.Attributes.ID
      description: The adversary's attribute ID
      type: number
    - contextPath: ThreatQ.Attributes.Name
      description: The adversary's attribute name
      type: string
    - contextPath: ThreatQ.Attributes.Value
      description: The adversary's attribute value
      type: string
    - contextPath: ThreatQ.UpdatedAt
      description: The creation date of the adversary
      type: date
    - contextPath: ThreatQ.CreatedAt
      description: The last update date of the adversary
      type: date
    description: Create a new adversary in ThreatQ
  - name: tq-create-event
    arguments:
    - name: title
      required: true
      description: Event title
    - name: event_type
      required: true
      auto: PREDEFINED
      predefined:
      - Spearphish
      - Watering Hole
      - SQL Injection Attack
      - DoS Attack
      - Malware
      - Watchlist
      - Command and Control
      - Anonymization
      - Exfiltration
      - Host Characteristics
      - Compromised PKI Certificate
      - Login Compromise
      - Incident
      description: Event type
    - name: date
      required: true
      description: 'Date of Occurrence. Valid formats: mm-dd-YYYY HH:MM:SS, mm/dd/YYYY  HH:MM:SS,
        mm.dd.YYYY HH:MM:SS, mm-dd-YYYY,  mm/dd/YYYY, mm.dd.YYYY'
    - name: source_lst
      description: Add sources
      isArray: true
    - name: attr_lst
      description: Add attributes
      isArray: true
    - name: attr_vals
      description: Attributes values
      isArray: true
    outputs:
    - contextPath: ThreatQ.ID
      description: The event's ID
      type: number
    - contextPath: ThreatQ.Sources.ID
      description: The event's source ID
      type: number
    - contextPath: ThreatQ.Sources.Name
      description: The event's source name
      type: string
    - contextPath: ThreatQ.Attributes.ID
      description: The event's attribute ID
      type: number
    - contextPath: ThreatQ.Attributes.Name
      description: The event's attribute name
      type: string
    - contextPath: ThreatQ.Attributes.Value
      description: The event's attribute value
      type: string
    - contextPath: ThreatQ.UpdatedAt
      description: The last update date of the event
      type: date
    - contextPath: ThreatQ.CreatedAt
      description: The creation date of the event
      type: date
    - contextPath: ThreatQ.Type
      description: The object's type - event
      type: string
    - contextPath: ThreatQ.Description
      description: Description about the event
      type: string
    - contextPath: ThreatQ.Title
      description: The event's title
      type: string
    - contextPath: ThreatQ.Occurred
      description: The date the event happened
      type: date
    - contextPath: ThreatQ.EventType
      description: The type of the event, e.g Spearphish
      type: string
    description: Create a new event in ThreatQ
  - name: tq-get-related-ioc
    arguments:
    - name: obj_id
      required: true
      description: Object's ID
    - name: obj_type
      required: true
      auto: PREDEFINED
      predefined:
      - indicator
      - event
      - adversary
      description: Object's type
    outputs:
    - contextPath: ThreatQ.Related.ID
      description: Related indicator's ID
      type: number
    - contextPath: ThreatQ.Related.Sources.ID
      description: Related indicator's source ID
      type: number
    - contextPath: ThreatQ.Related.Sources.Name
      description: Related indicator's source name
      type: string
    - contextPath: ThreatQ.Related.Attributes.ID
      description: Related indicator's attribute ID
      type: number
    - contextPath: ThreatQ.Related.Attributes.Name
      description: Related indicator's attribute name
      type: string
    - contextPath: ThreatQ.Related.Attributes.Value
      description: Related indicator's attribute value
      type: string
    - contextPath: ThreatQ.Related.UpdatedAt
      description: Related indicator's last update date
      type: date
    - contextPath: ThreatQ.Related.CreatedAt
      description: Related indicator's creation date
      type: date
    - contextPath: ThreatQ.Related.Type
      description: Related object type - indicator
      type: string
    - contextPath: ThreatQ.Related.Description
      description: Description about the related indicator
      type: string
    - contextPath: ThreatQ.Related.Value
      description: Related indicator value
      type: string
    - contextPath: ThreatQ.Related.Status
      description: Related indicator status
      type: string
    - contextPath: ThreatQ.Related.IndicatorType
      description: Related indicator type
      type: string
    - contextPath: ThreatQ.Related.TQScore
      description: Related indicator ThreatQ score
      type: number
    - contextPath: ThreatQ.ID
      description: Object ID
      type: number
    - contextPath: ThreatQ.Type
      description: Object type
      type: string
    description: Get related Indicators in ThreatQ
  - name: tq-update-status
    arguments:
    - name: ioc_id
      required: true
      description: Indicator's ID
    - name: status
      required: true
      auto: PREDEFINED
      predefined:
      - Active
      - Expired
      - Indirect
      - Review
      - Whitelisted
      description: Indicator's new Status
    description: Update an Indicator status in ThreatQ
  - name: tq-get-related-events
    arguments:
    - name: obj_id
      required: true
      description: Object's ID
    - name: obj_type
      required: true
      auto: PREDEFINED
      predefined:
      - indicator
      - event
      - adversary
      description: Object's type
    outputs:
    - contextPath: ThreatQ.Related.ID
      description: Related event ID
      type: number
    - contextPath: ThreatQ.Related.Sources.ID
      description: Related event source ID
      type: number
    - contextPath: ThreatQ.Related.Sources.Name
      description: Related event source name
      type: string
    - contextPath: ThreatQ.Related.Attributes.ID
      description: Related event attribute ID
      type: number
    - contextPath: ThreatQ.Related.Attributes.Name
      description: Related event attribute name
      type: string
    - contextPath: ThreatQ.Related.Attributes.Value
      description: Related event attribute value
      type: string
    - contextPath: ThreatQ.Related.UpdatedAt
      description: Related event last update date
      type: date
    - contextPath: ThreatQ.Related.CreatedAt
      description: Related event creation date
      type: date
    - contextPath: ThreatQ.Related.Description
      description: Description about the related event
      type: string
    - contextPath: ThreatQ.Related.Title
      description: Related event title
      type: string
    - contextPath: ThreatQ.Related.Occurred
      description: Related event date of occurrence
      type: date
    - contextPath: ThreatQ.Related.EventType
      description: Related event type
      type: string
    - contextPath: ThreatQ.Related.Type
      description: Related object type - event
      type: string
    - contextPath: ThreatQ.ID
      description: Object ID
      type: number
    - contextPath: ThreatQ.Type
      description: Object type
    description: Get related Events in ThreatQ
  - name: tq-get-related-adversaries
    arguments:
    - name: obj_id
      required: true
      description: Object's ID
    - name: obj_type
      required: true
      auto: PREDEFINED
      predefined:
      - indicator
      - event
      - adversary
      description: Object type
    outputs:
    - contextPath: ThreatQ.Related.ID
      description: Related adversary ID
      type: number
    - contextPath: ThreatQ.Related.Sources.ID
      description: Related adversary source ID
      type: number
    - contextPath: ThreatQ.Related.Sources.Name
      description: Related adversary source name
      type: string
    - contextPath: ThreatQ.Related.Attributes.ID
      description: Related adversary attribute ID
      type: number
    - contextPath: ThreatQ.Related.Attributes.Name
      description: Related adversary attribute name
      type: string
    - contextPath: ThreatQ.Related.Attributes.Value
      description: Related adversary attribute value
      type: string
    - contextPath: ThreatQ.Related.UpdatedAt
      description: Related adversary last update date
      type: date
    - contextPath: ThreatQ.Related.CreatedAt
      description: Related adversary creation date
      type: date
    - contextPath: ThreatQ.Related.Name
      description: Related adversary name
      type: string
    - contextPath: ThreatQ.Related.Type
      description: Related adversary type - adversary
      type: string
    - contextPath: ThreatQ.ID
      description: Object ID
      type: number
    - contextPath: ThreatQ.Type
      description: Object type
      type: string
    description: Get related Adversaries in ThreatQ
  - name: tq-upload-file
    arguments: []
    description: Uplad a file in ThreatQ
  - name: tq-search-by-id
    arguments:
    - name: obj_type
      required: true
      auto: PREDEFINED
      predefined:
      - indicator
      - adversary
      - event
      description: Object's type
    - name: obj_id
      required: true
      description: Object's ID
    outputs:
    - contextPath: ThreatQ.ID
      description: Object's ID
      type: number
    - contextPath: ThreatQ.Sources.ID
      description: Object's source ID
      type: number
    - contextPath: ThreatQ.Sources.Name
      description: Object's source name
      type: string
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: string
    - contextPath: DBotScore.Type
      description: Indicator type
      type: string
    - contextPath: DBotScore.Vendor
      description: Indicator vendor
      type: string
    - contextPath: DBotScore.Score
      description: Indicator DBot Score
      type: date
    - contextPath: ThreatQ.Attributes.ID
      description: Object's attribute ID
      type: number
    - contextPath: ThreatQ.Attributes.Name
      description: Object's attribute name
      type: string
    - contextPath: ThreatQ.Attributes.Value
      description: Object's attribute value
      type: string
    - contextPath: ThreatQ.UpdatedAt
      description: Object's last update date
      type: date
    - contextPath: ThreatQ.CreatedAt
      description: Object's creation date
      type: date
    - contextPath: ThreatQ.Type
      description: Object's type
      type: string
    - contextPath: ThreatQ.Description
      description: Description about the object
      type: string
    - contextPath: ThreatQ.Value
      description: Indicator's value
      type: string
    - contextPath: ThreatQ.Status
      description: Indicator's status
      type: string
    - contextPath: ThreatQ.IndicatorType
      description: Indicator's type, e.g IP Address
      type: string
    - contextPath: ThreatQ.TQScore
      description: Indicator's ThreatQ Score
      type: number
    - contextPath: ThreatQ.Name
      description: Adversary's name
      type: string
    - contextPath: ThreatQ.Title
      description: Event's title
      type: string
    - contextPath: ThreatQ.Occurred
      description: Event's occurrence date
      type: date
    - contextPath: ThreatQ.EventType
      description: Event's type
      type: string
    - contextPath: IP.Address
      description: An IP address
      type: string
    - contextPath: URL.Data
      description: A URL data
      type: string
    - contextPath: File.Name
      description: A file name
      type: string
    - contextPath: File.MD5
      description: A file MD5
      type: string
    - contextPath: File.Path
      description: A file path
      type: string
    - contextPath: File.SHA1
      description: A file SHA1
      type: string
    - contextPath: File.SHA256
      description: A file SHA256
      type: string
    - contextPath: File.SHA512
      description: A file SHA512
      type: string
    - contextPath: Email.From
      description: An email address
      type: string
    - contextPath: Email.Subject
      description: An email subject
      type: string
    - contextPath: Email.Attachments
      description: An email attachment
      type: string
    - contextPath: Domain.Name
      description: A domain name
      type: string
    - contextPath: Account.Username
      description: An account username
      type: string
    - contextPath: CVE.ID
      description: A CVE ID
      type: string
    - contextPath: Service.Name
      description: A service name
      type: string
    - contextPath: RegistryKey.Path
      description: A registry key path
      type: string
    - contextPath: Event.Type
      description: An event type, e.g Spearphish
      type: string
    - contextPath: Event.ID
      description: An event ID
      type: number
    - contextPath: Event.Name
      description: An event title
      type: string
    - contextPath: IP.Malicious.Vendor
      description: IP vendor
      type: string
    - contextPath: IP.Malicious.Description
      description: IP Malicious description
      type: string
    - contextPath: URL.Malicious.Vendor
      description: URL vendor
      type: string
    - contextPath: URL.Malicious.Description
      description: URL Malicious description
      type: string
    - contextPath: File.Malicious.Vendor
      description: File vendor
      type: string
    - contextPath: File.Malicious.Description
      description: File Malicious description
      type: string
    - contextPath: Email.Malicious.Vendor
      description: Email vendor
      type: string
    - contextPath: Email.Malicious.Description
      description: Email Malicious description
      type: string
    - contextPath: Domain.Malicious.Vendor
      description: Domain vendor
      type: string
    - contextPath: Domain.Malicious.Description
      description: Domain Malicious description
      type: string
    - contextPath: Account.Malicious.Vendor
      description: Account vendor
      type: string
    - contextPath: Account.Malicious.Description
      description: Account Malicious description
      type: string
    - contextPath: RegistryKey.Malicious.Vendor
      description: Registry key vendor
      type: string
    - contextPath: RegistryKey.Malicious.Description
      description: Registry key Malicious description
      type: string
    - contextPath: CVE.Malicious.Vendor
      description: CVE vendor
      type: string
    - contextPath: CVE.Malicious.Description
      description: CVE Malicious description
      type: string
    - contextPath: Service.Malicious.Vendor
      description: Service vendor
      type: string
    - contextPath: Service.Malicious.Description
      description: Service Malicious description
      type: string
    description: Search for an object by it's type and ID. When possible, generic
      and DBotScore contexts will be generated as well.
  - name: tq-unlink-objects
    arguments:
    - name: obj1_id
      required: true
      description: First object's ID
    - name: obj1_type
      required: true
      auto: PREDEFINED
      predefined:
      - adversary
      - indicator
      - event
      description: First object's type
    - name: obj2_id
      required: true
      description: Second object's ID
    - name: obj2_type
      required: true
      auto: PREDEFINED
      predefined:
      - adversary
      - indicator
      - event
      description: Second object's type
    description: Unlink two objects in ThreatQ
  - name: tq-delete-object
    arguments:
    - name: obj_id
      required: true
      description: Object's ID
    - name: obj_type
      required: true
      auto: PREDEFINED
      predefined:
      - indicator
      - event
      - adversary
      description: Object's type
    description: Delete an object in ThreatQ
  - name: tq-add-source
    arguments:
    - name: obj_id
      required: true
      description: Object ID
    - name: obj_type
      required: true
      auto: PREDEFINED
      predefined:
      - indicator
      - adversary
      - event
      description: Object type
    - name: source
      required: true
      description: Source name
    description: Add a source to an object in ThreatQ
  - name: tq-delete-source
    arguments:
    - name: source
      required: true
      description: Source name
    - name: obj_id
      required: true
      description: Object ID
    - name: obj_type
      required: true
      auto: PREDEFINED
      predefined:
      - indicator
      - adversary
      - event
      description: Object type
    description: Delete a source from an object in ThreatQ
  - name: tq-delete-attr
    arguments:
    - name: attr_id
      required: true
      description: Attribute ID
    - name: obj_id
      required: true
      description: Object ID
    - name: obj_type
      required: true
      auto: PREDEFINED
      predefined:
      - indicator
      - adversary
      - event
      description: Object type
    description: Delete an attribute from an object in ThreatQ
  dockerimage: demisto/python3:3.7.4.977
  runonce: false
  subtype: python3