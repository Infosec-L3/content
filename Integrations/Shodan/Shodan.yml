category: Data Enrichment & Threat Intelligence
commonfields:
  id: Shodan_v2
  version: -1
configuration:
- display: Api Key
  name: api_key
  required: true
  type: 4
- defaultvalue: https://api.shodan.io
  display: Base url to Shodan API
  name: api_url
  required: true
  type: 0
- display: Trust self-signed certificate (insecure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: search engine for Internet-connected devices
display: Shodan_v2
name: Shodan_v2
script:
  commands:
  - arguments:
    - default: true
      description: 'Shodan search query. The provided string is used to search the
        database of banners in Shodan, with the additional option to provide filters
        inside the search query using a "filter:value" format. For example, the following
        search query would find Apache webservers located in Germany: "apache country:DE"'
      isArray: false
      name: query
      required: true
      secret: false
    - default: false
      description: A comma-separated list of properties to get summary information
        on. Property names can also be in the format of "property:count", where "count"
        is the number of facets that will be returned for a property (i.e. "country:100"
        to get the top 100 countries for a search query)
      isArray: false
      name: facets
      required: false
      secret: false
    - default: false
      defaultValue: '1'
      description: Result page number to be fetched. Each page contains up to 100
        results.
      isArray: false
      name: page
      required: false
      secret: false
    deprecated: false
    description: Search Shodan using the same query syntax as the website and use
      facets to get summary information for different properties.
    execution: false
    name: search
  - arguments:
    - default: true
      description: Host IP address
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Returns all services that have been found on the given host IP.
    execution: false
    name: ip
    outputs:
    - contextPath: IP.ASN
      description: Autonomous System Number (ASN) such as IP owner
      type: Unknown
    - contextPath: IP.Address
      description: IP Address
      type: Unknown
    - contextPath: IP.Geo.Country
      description: Country of given IP
      type: Unknown
    - contextPath: IP.Geo.Description
      description: 'Description of location '
      type: Unknown
    - contextPath: IP.Geo.Location
      description: Latitude and longitude of given IP
      type: Unknown
    - contextPath: IP.Hostname
      description: Hostname
      type: Unknown
    - contextPath: Shodan.IP.Tag
      type: String
    - contextPath: Shodan.IP.Latitude
      type: Number
    - contextPath: Shodan.IP.Org
      type: String
    - contextPath: Shodan.IP.ASN
      type: String
    - contextPath: Shodan.IP.ISP
      type: String
    - contextPath: Shodan.IP.Longitude
      type: Number
    - contextPath: Shodan.IP.LastUpdate
      type: Date
    - contextPath: Shodan.IP.CountryName
      type: String
    - contextPath: Shodan.IP.OS
      type: String
    - contextPath: Shodan.IP.Port
      type: Unknown
    - contextPath: Shodan.IP.Address
      type: String
  - arguments:
    - default: false
      description: Shodan search query. The provided string is used to search the
        database of banners in Shodan, with the additional option to provide filters
        inside the search query using a "filter:value" format.
      isArray: false
      name: query
      required: true
      secret: false
    deprecated: false
    execution: false
    name: shodan-search-count
    outputs:
    - contextPath: Shodan.Search.ResultCount
      type: Number
  - arguments:
    - default: false
      description: A comma-separated list of IPs or netblocks (in CIDR notation) that
        should get crawled.
      isArray: false
      name: ips
      required: true
      secret: false
    deprecated: false
    execution: false
    name: shodan-scan-ip
    outputs:
    - contextPath: Shodan.Scan.ID
      type: String
    - contextPath: Shodan.Scan.Status
      type: String
  - arguments:
    - default: false
      description: The port that Shodan should crawl the Internet for
      isArray: false
      name: port
      required: true
      secret: false
    - default: false
      description: The name of the protocol that should be used to interrogate the
        port.
      isArray: false
      name: protocol
      required: true
      secret: false
    deprecated: false
    description: This method is restricted to security researchers and companies with
      a Shodan Enterprise Data license
    execution: false
    name: shodan-scan-internet
    outputs:
    - contextPath: Shodan.Scan.ID
      type: String
  - arguments:
    - default: false
      description: The unique scan ID that was returned by /shodan/scan.
      isArray: false
      name: scanID
      required: true
      secret: false
    deprecated: false
    execution: false
    name: shodan-scan-status
    outputs:
    - contextPath: Shodan.Scan.Id
      type: String
    - contextPath: Shodan.Scan.Status
      type: String
  - arguments:
    - default: false
      description: The name to describe the network alert
      isArray: false
      name: alertName
      required: true
      secret: false
    - default: false
      description: A list of IPs or network ranges defined using CIDR notation
      isArray: false
      name: ip
      required: true
      secret: false
    - default: false
      description: Number of seconds that the alert should be active
      isArray: false
      name: expires
      required: false
      secret: false
    deprecated: false
    execution: false
    name: shodan-create-network-alert
    outputs:
    - contextPath: Shodan.Alert.ID
      type: String
    - contextPath: Shodan.Alert.Expires
      type: String
  - arguments:
    - default: false
      description: AlertId
      isArray: false
      name: alertId
      required: true
      secret: false
    deprecated: false
    execution: false
    name: shodan-network-get-alert-by-id
    outputs:
    - contextPath: Shodan.Alert.Id
      type: String
    - contextPath: Shodan.Alert.Expires
      type: String
  - deprecated: false
    execution: false
    name: shodan-network-get-alerts
    outputs:
    - contextPath: Shodan.Alert.Id
      type: String
    - contextPath: Shodan.Alert.Expires
      type: String
  - arguments:
    - default: false
      description: AlertId
      isArray: false
      name: alertId
      required: true
      secret: false
    deprecated: false
    execution: false
    name: shodan-network-delete-alert
  - arguments:
    - default: false
      description: AlertId
      isArray: false
      name: alertId
      required: true
      secret: false
    - default: false
      description: Trigger name
      isArray: false
      name: Trigger
      required: true
      secret: false
    deprecated: false
    execution: false
    name: shodan-network-alert-set-trigger
  - arguments:
    - default: false
      description: AlertId
      isArray: false
      name: alertId
      required: true
      secret: false
    - default: false
      description: Trigger name
      isArray: false
      name: Trigger
      required: true
      secret: false
    deprecated: false
    execution: false
    name: shodan-network-alert-remove-trigger
  - arguments:
    - default: false
      description: AlertId
      isArray: false
      name: alertId
      required: true
      secret: false
    - default: false
      description: Trigger name
      isArray: false
      name: trigger
      required: true
      secret: false
    - default: false
      description: Service specified in the format "ip:port" (ex. "1.1.1.1:80")
      isArray: false
      name: service
      required: true
      secret: false
    deprecated: false
    execution: false
    name: shodan-network-alert-whitelist-service
  - arguments:
    - default: false
      description: AlertId
      isArray: false
      name: alertId
      required: true
      secret: false
    - default: false
      description: Trigger name
      isArray: false
      name: trigger
      required: true
      secret: false
    - default: false
      description: Service specified in the format "ip:port" (ex. "1.1.1.1:80")
      isArray: false
      name: service
      required: true
      secret: false
    deprecated: false
    execution: false
    name: shodan-network-alert-remove-service-from-whitelist
  dockerimage: demisto/python3:3.7.3.286
  isfetch: false
  runonce: false
  script: '-'
  type: python
tests:
- ShodanTest
