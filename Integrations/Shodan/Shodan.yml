category: Data Enrichment & Threat Intelligence
commonfields:
  id: Shodan_v2
  version: -1
configuration:
- display: Api Key
  name: api_key
  required: true
  type: 4
- defaultvalue: https://api.shodan.io
  display: Base url to Shodan API
  name: api_url
  required: true
  type: 0
- display: Trust self-signed certificate (insecure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: search engine for Internet-connected devices
display: Shodan_v2
name: Shodan_v2
script:
  commands:
  - arguments:
    - default: true
      description: 'Shodan search query. The provided string is used to search the
        database of banners in Shodan, with the additional option to provide filters
        inside the search query using a "filter:value" format. For example, the following
        search query would find Apache webservers located in Germany: "apache country:DE"'
      isArray: false
      name: query
      required: true
      secret: false
    - default: false
      description: A comma-separated list of properties to get summary information
        on. Property names can also be in the format of "property:count", where "count"
        is the number of facets that will be returned for a property (i.e. "country:100"
        to get the top 100 countries for a search query)
      isArray: false
      name: facets
      required: false
      secret: false
    - default: false
      defaultValue: '1'
      description: Result page number to be fetched. Each page contains up to 100
        results.
      isArray: false
      name: page
      required: false
      secret: false
    deprecated: false
    description: Search Shodan using the same query syntax as the website and use
      facets to get summary information for different properties.
    execution: false
    name: search
    outputs:
    - contextPath: Shodan.Banner.Org
      description: The name of the organization that is assigned the IP space for
        this device
      type: String
    - contextPath: Shodan.Banner.Isp
      description: The ISP that is providing the organization with the IP space for
        this device. Consider this the "parent" of the organization in terms of IP
        ownership
      type: String
    - contextPath: Shodan.Banner.Transport
      description: Either "udp" or "tcp" to indicate which IP transport protocol was
        used to fetch the information
      type: String
    - contextPath: Shodan.Banner.Asn
      description: The autonomous system number (ex. "AS4837").
      type: String
    - contextPath: Shodan.Banner.IP
      description: The IP address of the host as a string
      type: String
    - contextPath: Shodan.Banner.Port
      description: The port number that the service is operating on
      type: Number
    - contextPath: Shodan.Banner.Ssl.versions
      description: 'list of SSL versions that are supported by the server. If a version
        isnt supported the value is prefixed with a "-". Example: ["TLSv1", "-SSLv2"]
        means that the server supports TLSv1 but doesnt support SSLv2.'
      type: String
    - contextPath: Shodan.Banner.Hostnames
      description: An array of strings containing all of the hostnames that have been
        assigned to the IP address for this device.
      type: String
    - contextPath: Shodan.Banner.Location.City
      description: The name of the city where the device is located
      type: String
    - contextPath: Shodan.Banner.Location.Longitude
      description: The longitude for the geolocation of the device
      type: Number
    - contextPath: Shodan.Banner.Location.Latitude
      description: The latitude for the geolocation of the device
      type: Number
    - contextPath: Shodan.Banner.Location.Country
      description: The name of the country where the device is located
      type: String
    - contextPath: Shodan.Banner.Timestamp
      description: The timestamp for when the banner was fetched from the device in
        the UTC timezone
      type: Date
    - contextPath: Shodan.Banner.Domains
      description: An array of strings containing the top-level domains for the hostnames
        of the device. This is a utility property in case you want to filter by TLD
        instead of subdomain. It is smart enough to handle global TLDs with several
        dots in the domain (ex. "co.uk")
      type: String
    - contextPath: Shodan.Banner.OS
      description: The operating system that powers the device
      type: String
  - arguments:
    - default: true
      description: Host IP address
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Returns all services that have been found on the given host IP.
    execution: false
    name: ip
    outputs:
    - contextPath: IP.ASN
      description: Autonomous System Number (ASN) such as IP owner
      type: Unknown
    - contextPath: IP.Address
      description: IP Address
      type: Unknown
    - contextPath: IP.Geo.Country
      description: Country of given IP
      type: Unknown
    - contextPath: IP.Geo.Description
      description: 'Description of location '
      type: Unknown
    - contextPath: IP.Geo.Location
      description: Latitude and longitude of given IP
      type: Unknown
    - contextPath: IP.Hostname
      description: Hostname
      type: Unknown
    - contextPath: Shodan.IP.Tags
      description: The tags related to the IP
      type: String
    - contextPath: Shodan.IP.Latitude
      description: The latitude for the geolocation of the device
      type: Number
    - contextPath: Shodan.IP.Org
      description: The name of the organization that is assigned the IP space for this device
      type: String
    - contextPath: Shodan.IP.ASN
      description: The autonomous system number (ex. "AS4837").
      type: String
    - contextPath: Shodan.IP.ISP
      description: The ISP that is providing the organization with the IP space for this device. Consider this the "parent" of the organization in terms of IP ownership
      type: String
    - contextPath: Shodan.IP.Longitude
      description: The Longitude for the geolocation of the device
      type: Number
    - contextPath: Shodan.IP.LastUpdate
      description: The timestamp for when the banner was fetched from the device in the UTC timezone
      type: Date
    - contextPath: Shodan.IP.CountryName
      description: The name of the country where the device is located
      type: String
    - contextPath: Shodan.IP.OS
      description: The operating system that powers the device
      type: String
    - contextPath: Shodan.IP.Port
      description: The port number that the service is operating on
      type: Number
    - contextPath: Shodan.IP.Address
      description: The IP address of the host as a string
      type: String
  - arguments:
    - default: false
      description: Shodan search query. The provided string is used to search the
        database of banners in Shodan, with the additional option to provide filters
        inside the search query using a "filter:value" format.
      isArray: false
      name: query
      required: true
      secret: false
    deprecated: false
    description: This method behaves identical to "shodan-search" with the only difference that this method does not return any host results, it only returns the total number of results that matched the query and any facet information that was requested. As a result this method does not consume query credits.
    execution: false
    name: shodan-search-count
    outputs:
    - contextPath: Shodan.Search.ResultCount
      description: Number of results generated by the search query
      type: Number
  - arguments:
    - default: false
      description: A comma-separated list of IPs or netblocks (in CIDR notation) that
        should get crawled.
      isArray: false
      name: ips
      required: true
      secret: false
    deprecated: false
    description: Use this method to request Shodan to crawl a network.
    execution: false
    name: shodan-scan-ip
    outputs:
    - contextPath: Shodan.Scan.ID
      description: The unique scan ID that was returned by shodan-scan-ip.
      type: String
    - contextPath: Shodan.Scan.Status
      description: The status of the scan job
      type: String
  - arguments:
    - default: false
      description: The port that Shodan should crawl the Internet for
      isArray: false
      name: port
      required: true
      secret: false
    - default: false
      description: The name of the protocol that should be used to interrogate the
        port.
      isArray: false
      name: protocol
      required: true
      secret: false
    deprecated: false
    description: This method is restricted to security researchers and companies with
      a Shodan Enterprise Data license
    execution: false
    name: shodan-scan-internet
    outputs:
    - contextPath: Shodan.Scan.ID
      description: TODO
      type: String
  - arguments:
    - default: false
      description: The unique scan ID that was returned by shodan-scan.
      isArray: false
      name: scanID
      required: true
      secret: false
    deprecated: false
    description: Check the progress of a previously submitted scan request
    execution: false
    name: shodan-scan-status
    outputs:
    - contextPath: Shodan.Scan.Id
      description: The unique scan ID that was returned by shodan-scan
      type: String
    - contextPath: Shodan.Scan.Status
      description: The status of the scan job
      type: String
  - arguments:
    - default: false
      description: The name to describe the network alert
      isArray: false
      name: alertName
      required: true
      secret: false
    - default: false
      description: A list of IPs or network ranges defined using CIDR notation
      isArray: false
      name: ip
      required: true
      secret: false
    - default: false
      description: Number of seconds that the alert should be active
      isArray: false
      name: expires
      required: false
      secret: false
    deprecated: false
    description: Use this method to create a network alert for a defined IP/ netblock which can be used to subscribe to changes/ events that are discovered within that range.
    execution: false
    name: shodan-create-network-alert
    outputs:
    - contextPath: Shodan.Alert.ID
      description: The id of the alert subscription
      type: String
    - contextPath: Shodan.Alert.Expires
      description: Number of seconds that the alert should be active
      type: String
  - arguments:
    - default: false
      description: AlertID
      isArray: false
      name: alertID
      required: true
      secret: false
    deprecated: false
    description: Get the details for a network alert
    execution: false
    name: shodan-network-get-alert-by-id
    outputs:
    - contextPath: Shodan.Alert.ID
      description: The id of the alert subscription
      type: String
    - contextPath: Shodan.Alert.Expires
      description: Number of seconds that the alert should be active
      type: String
  - deprecated: false
    description: Get a list of all the created alerts
    execution: false
    name: shodan-network-get-alerts
    outputs:
    - contextPath: Shodan.Alert.ID
      description: The id of the alert subscription
      type: String
    - contextPath: Shodan.Alert.Expires
      description: Number of seconds that the alert should be active
      type: String
  - arguments:
    - default: false
      description: AlertID
      isArray: false
      name: alertID
      required: true
      secret: false
    deprecated: false
    description: Remove the specified network alert.
    execution: false
    name: shodan-network-delete-alert
  - arguments:
    - default: false
      description: AlertID
      isArray: false
      name: alertID
      required: true
      secret: false
    - default: false
      description: Trigger name
      isArray: false
      name: Trigger
      required: true
      secret: false
    deprecated: false
    description: Get notifications when the specified trigger is met.
    execution: false
    name: shodan-network-alert-set-trigger
  - arguments:
    - default: false
      description: AlertID
      isArray: false
      name: alertID
      required: true
      secret: false
    - default: false
      description: Trigger name
      isArray: false
      name: Trigger
      required: true
      secret: false
    deprecated: false
    description: Stop getting notifications for the specified trigger.
    execution: false
    name: shodan-network-alert-remove-trigger
  - arguments:
    - default: false
      description: AlertID
      isArray: false
      name: alertID
      required: true
      secret: false
    - default: false
      description: Trigger name
      isArray: false
      name: trigger
      required: true
      secret: false
    - default: false
      description: Service specified in the format "ip:port" (ex. "1.1.1.1:80")
      isArray: false
      name: service
      required: true
      secret: false
    deprecated: false
    description: Ignore the specified service when it is matched for the trigger.
    execution: false
    name: shodan-network-alert-whitelist-service
  - arguments:
    - default: false
      description: AlertID
      isArray: false
      name: alertID
      required: true
      secret: false
    - default: false
      description: Trigger name
      isArray: false
      name: trigger
      required: true
      secret: false
    - default: false
      description: Service specified in the format "ip:port" (ex. "1.1.1.1:80")
      isArray: false
      name: service
      required: true
      secret: false
    deprecated: false
    description: Start getting notifications again for the specified trigger.
    execution: false
    name: shodan-network-alert-remove-service-from-whitelist
  dockerimage: demisto/python3:3.7.3.286
  isfetch: false
  runonce: false
  script: '-'
  type: python
tests:
- "Test-Shodan_v2"
